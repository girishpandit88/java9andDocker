{
  "name": "Java9anddocker",
  "tagline": "demo of how to run minimalist images of your app",
  "body": "Java9 and Docker - minimalist future is here\r\n==============================================\r\n\r\n\r\n### Steps to install java9 on ubuntu (included a provision script, invoked when vagrant launches)\r\n\r\n```\r\nsudo add-apt-repository ppa:webupd8team/java\r\nsudo apt-get install oracle-java9-installer\r\nsudo apt-get install oracle-java9-set-default\r\nexport JAVA_HOME=/usr/lib/jvm/java-9-oracle\r\nexport MODS=$JAVA_HOME/jmods/\r\n```\r\n\r\n\r\n### confirm java version\r\n```\r\n> java -version\r\njava version \"9-ea\"\r\nJava(TM) SE Runtime Environment (build 9-ea+140)\r\nJava HotSpot(TM) 64-Bit Server VM (build 9-ea+140, mixed mode)\r\n```\r\n\r\n### now cd to your working directory\r\n```bash\r\n> cd /vagrant/\r\n> tree\r\n├── Dockerfile\r\n├── Readme.md\r\n├── src\r\n│   └── com.greetings\r\n│       ├── com\r\n│       │   └── greetings\r\n│       │       └── HelloWorld.java\r\n│       └── module-info.java\r\n└── Vagrantfile\r\n```\r\n\r\n### compile HelloWorld java9 style\r\n```\r\n> javac -d mods/com.greetings src/com.greetings/module-info.java src/com.greetings/com/greetings/HelloWorld.java`\r\n```\r\n\r\n### run HelloWorld::main\r\n```\r\n> java --module-path mods -m com.greetings/com.greetings.HelloWorld\r\nexport MODS=/usr/lib/jvm/java-9-oracle/jmods/\r\nHello World\r\n```\r\n\r\n### build your runtime image using the jlink command\r\n```\r\n> jlink --module-path mlib:$MODS --add-modules com.greetings --output image\r\n\r\n> tree image -L 2\r\nimage\r\n├── bin\r\n│   ├── com.greetings\r\n│   ├── java\r\n│   └── keytool\r\n├── conf\r\n│   ├── net.properties\r\n│   └── security\r\n├── lib\r\n│   ├── amd64\r\n│   ├── jexec\r\n│   ├── modules\r\n│   ├── security\r\n│   └── tzdb.dat\r\n└── release\r\n\r\n>./image/bin/com.greetings \r\nHello World\r\n```\r\n\r\n### build the Dockerfile\r\n```bash\r\n> docker build . -t greetings\r\n```\r\n\r\n### run the built docker image\r\n```bash\r\n> docker run greetings\r\nHello World\r\n```\r\n\r\n### size of docker images\r\n```bash\r\n> docker images \r\ngreetings   latest    31f997624827  34 minutes ago      169.7 MB\r\n<none>      <none>    fa96f037e908  36 minutes ago      169.7 MB\r\nubuntu      latest    e4415b714b62  5 days ago          128.1 MB\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}